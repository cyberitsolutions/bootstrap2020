Source: prisonpc-ersatz
Section: metapackages
Priority: optional
Standards-Version: 4.3.0
Maintainer: Trent W. Buck <twb@cyber.com.au>
Uploaders: Trent W. Buck <trentbuck@gmail.com>
Rules-Requires-Root: no
Build-Depends: debhelper-compat (= 13)

Package: prisonpc-ersatz-gpg
Depends: ${misc:Depends}
Provides:
 gpg,
Conflicts:
 gpg,
Replaces:
 gpg,
Architecture: all
Description: appease libreoffice
 Inmates SHOULD NOT have access to "unnecessary" cryptography.
 .
 LibreOffice 6+ has a hard dependency on libgpgme.
 If we remove libgpgme, libreoffice won't even start.
 HOWEVER, libgpgme really just fork-and-execs /bin/gpg, then
 talks to it over stdio.
 .
 So we trick apt into shipping libgpgme but not gpg,
 all of libreoffice will work except for password-protected documents.

Package: prisonpc-ersatz-e2fsprogs
Depends: ${misc:Depends}
Provides:  e2fsprogs (= 1.47.0-2)
Conflicts: e2fsprogs
Replaces:  e2fsprogs
Essential: yes
Architecture: all
Description: work around https://bugs.debian.org/1000353
 Inmates must not have access to local persistent storage.
 We remove mke2fs (& debugfs &c) as part of that requirement.
 .
 We install gvfs to provide trash:// in thunar file manager.
 This depends on e2fsprogs via
 gvfs → gvfs-daemons → udisks2 → libblockdev-fs2 → e2fsprogs.
 This is a Depends due to https://bugs.debian.org/887270
 It should probably be a Recommends due to runtime checks:
 https://codesearch.debian.net/search?q=bd_fs_ext_is_tech_avail
 Therefore we need a fake e2fsprogs.
 .
 We install quota package for its /usr/bin/quota.
 In Debian 9 its unused /sbin/quotacheck needed libext2fs2 (as "e2fslibs").
 In Debian 11 this issue is gone.
 .
 We install initramfs-tools to build a live-boot ramdisk.
 initramfs-tools needs logsave (from e2fsprogs) to fsck ANY rootfs.
 PrisonPC systems are diskless, so we do not use fsck.
 In Debian 9, logsave was in the e2fsprogs .deb.
 In Debian 11, logsave is a separate .deb.
 As logsave is harmless, we do not nerf it.

Package: prisonpc-ersatz-logrotate
Depends: ${misc:Depends},
Provides:  logrotate
Conflicts: logrotate
Replaces:  logrotate
Architecture: all
Description: appease prayer
 This stub package lets us remove logrotate without apt knowing.
 .
 The default prayer config writes directly into /var/log/prayer/,
 so it has a hard dependency on logrotate (to avoid filling /var/log).
 .
 Our prayer config doesn't use logfiles,
 so we don't need logrotate.
 This also lets us avoid installing cron.

Package: prisonpc-ersatz-kio
Depends: ${misc:Depends}
Provides:  kio (= 5.103.0-1),
Conflicts: kio,
Replaces:  kio,
Architecture: all
Description: appease KDE games and KDE educational apps
 In KDE4, every KDE app depended on "kdelibs", which was *every* KDE library.
 So even if you didn't use any apps that (say) opened files, you still had the
 whole KDE SFTP driver.
 .
 KDE5 is much nicer, but "kio" library still pulls in kwallet (KDE password manager).
 We don't need this, so spoof it away.
 .
 Note that kwallet probably doesn't actually WORK without gpg.
 We already nerf gpg/gnupg, so this is probably harmless either way.
 .
 UPDATE: actually we can be even more ruthless.
 KDEedu apps depend on kio indirectly via libraries like
 libkeduvocdocument5 and libkf5newstuff5.
 But I experimentally ran this, and apps still worked (including File > Open):
 .
  dpkg --purge --force-depends kio kded5 libkf5doctools5 libkf5kiontlm5 libkf5solid5 libkf5solid5-data
 .
 Therefore, instead of spoofing kwallet, we spoof kio itself.

Package: prisonpc-ersatz-parted
Depends: ${misc:Depends}
Provides:  parted,
Conflicts: parted,
Replaces:  parted,
Architecture: all
Description: appease udisks2
 We install udisks2 so thunar can mount and eject read-only optical media (DVDs).
 udisks2 hard-depends on parted so it can create GPT partitions.
 https://sources.debian.org/src/udisks2/2.9.4-1/src/udiskslinuxfsinfo.c/?hl=226#L226
 We never want this, so nerf this.
 .
 FIXME: do we need parted for staff desktops?
 I don't think so -- staff occasionally want to mount USB keys, but
 if they want to INITIALIZE a USB key, they can use their normal PC.

Package: prisonpc-ersatz-dictionaries-common
Depends: ${misc:Depends}
Provides:  dictionaries-common (= 1.29.5),
Replaces:  dictionaries-common,
Conflicts: dictionaries-common,
# These things really DO need dictionaries-common, so
# make apt complain if you try to install any of them.
 emacsen, wordlist,
 ispell, ispell-dictionary,
 aspell, aspell-dictionary,
 myspell, myspell-dictionary,
 dictionaries-common-dev,
# We cannot block this, because we genuinely do use mythes-thesaurus (mythes-en-us).
# This isn't obsoleted by hunspell, the way ispell/aspell/myspell are.
# mythes-thesaurus,
Architecture: all
Description: appease hunspell-en-au
 We install hunspell dictionaries so LibreOffice can do spell-checking.
 .
 hunspell-* hard-depends on dictionaries-common which AFAICT is only REALLY
 needed for older spelling engines (ispell/aspell/myspell) and maybe Emacs.
 libreoffice does NOT need dictionaries-common, so just nerf it.
 .
 This avoids a little emacs/debconf/perl crap.
 .
 Note that Chromium already has special handling (which doesn't use dictionaries-common):
 https://github.com/cyberitsolutions/bootstrap2020/tree/main/debian-12-PrisonPC.packages/prisonpc-chromium-hunspell-dictionaries/debian

Package: prisonpc-bad-package-conflicts-inmates
Depends:
 ${misc:Depends},
 prisonpc-bad-package-conflicts-everyone (= ${binary:Version}),
Enhances:
 prisonpc-bad-package-conflicts-everyone,
# This "replaces" helps if you are bisecting old bootstrap2020 commits.
# It isn't needed for anything normal.
Replaces: prisonpc-bad-package-conflicts,
Architecture: all
Description:
 Most bad packages can be banned for everyone.
 That is done in prisonpc-bad-package-conflicts
 This package amends that to also ban things
 inmates MUST NOT have, but staff MUST have.
Conflicts:
 xfce4-terminal, x-terminal-emulator, libvte-2.91-0,
 mousepad, libgtksourceview-4-0,
 xfce4-screenshooter,
# NOTE: staff need ntfs3 and exfat
# https://alloc.cyber.com.au/task/task.php?taskID=24592
# https://alloc.cyber.com.au/task/task.php?taskID=32658
# NOTE: exfat-fuse removed as exfat is now in-kernel.
# https://kernelnewbies.org/Linux_5.7#New_exFAT_file_system
# FIXME: move ntfs-3g to prisonpc-bad-package-conflicts-everyone
#        when 5.15 reaches bullseye-backports.
# https://kernelnewbies.org/Linux_5.15#New_NTFS_file_system_implementation
# UPDATE 2023: block libburn4 (and most CD/DVD burning tools) for inmates.
#              Staff need it for the xfburn4 GUI app.
 ntfs-3g,
 libburn4,
# Browse p123's home (sftp://)
 gvfs-backends,
 gvfs-fuse, fuse, fuse3, python3-pyfuse3,
# See -everyone stanza's comments re NNNNN-udev-audit.py.
 libgphoto2-6,
# Mike wants this for prisonpc-desktop-staff-amc in spice-html5.
# See -everyone stanza's comments re NNNNN-udev-audit.py.
 qemu-guest-agent,
 spice-vdagent,

Package: prisonpc-bad-package-conflicts-everyone
Depends:
 ${misc:Depends},
 prisonpc-ersatz-gpg (= ${binary:Version}),
 prisonpc-ersatz-e2fsprogs (= ${binary:Version}),
 prisonpc-ersatz-logrotate (= ${binary:Version}),
 prisonpc-ersatz-kio (= ${binary:Version}),
 prisonpc-ersatz-parted (= ${binary:Version}),
 prisonpc-ersatz-dictionaries-common (= ${binary:Version}),
Conflicts:
## Inmates MUST NOT have unnecessary crypto
## ========================================
# ?source-package(^gnupg2$), except for
#   gpgv (apt needs it), &
#   gpg  (handled by prisonpc-ersatz-gpg).
# $ aptitude search -F ' %p,' '?source-package(^gnupg2$) ?not(?name(^gpgv?$))'
 dirmngr,
 gnupg,
 gnupg-agent,
 gnupg-l10n,
 gnupg-utils,
 gnupg2,
 gpg-agent,
 gpg-wks-client,
 gpg-wks-server,
 gpgconf,
 gpgsm,
 gpgv-static,
 gpgv-win32,
 gpgv2,
 scdaemon,
# $ aptitude search -F ' %p,' '?source-package(^gnupg1$)'
 gnupg1,
 gnupg1-l10n,
 gpgv1,
# pinentry-gnome3 &c provide GUI password prompts, mostly for gpg
 pinentry,
# askpass-gnome &c provide GUI password prompts, mostly for ssh
 ssh-askpass,
# GNOME password manager is not needed.
# FIXME: gvfs-libs needs libgcr-base-3-1 and libgck-1-0 so we can't Conflicts (only Provides).
# FIXME: libgnutls30 needs libp11-kit0 so we can't Conflicts (only Provides).
 gcr, gir1.2-gck-1, gir1.2-gcr-3, libgcr-ui-3-1,
 gnome-keyring, libpam-gnome-keyring, gnome-keyring-pkcs11,
 seahorse, caja-seahorse, seahorse-nautilus,
 libcryptui0a, gir1.2-cryptui-0.0, seahorse-daemon,
 libp11-3, p11-kit, p11-kit-modules, libpam-p11,
 gnome-keysign,
 libpam-gnome-keyring,
 pidgin-gnome-keyring,
# KDE password manager is not needed.
 libkf5wallet-bin, libkf5wallet5,
 kwalletcli,
 libkf5wallet-data, libkwalletbackend5-5,
 libpam-kwallet-common, libpam-kwallet5,
 signon-kwallet-extension,
 kwalletmanager, remmina-plugin-kwallet,
# zip/bullseye only supports weak encryption, but
# later versions might adopt strong encryption.
# https://en.wikipedia.org/wiki/ZIP_(file_format)#Encryption
# NOTE: libreoffice also supports ODF/OOXML encryption.
# UPDATE 2021: .rar and .7z also support AES.
# libarchive (bsdtar) can DEFINITELY created strongly encrypted zip files.
# We can't remove libarchive itself without upsetting vlc (everyone) and gvfs-backends (staff).
 p7zip,
 p7zip-full,
 unrar,
 unrar-nonfree,
 zip,
 libarchive-tools,
## Inmates MUST NOT have clandestine comms
## =======================================
 bluez,
 avahi-daemon,
# It's THEORETICALLY possible to use wesnoth<->wesnoth-server and then do in-game chat,
# which would give the inmate a clandestine comms channel.
 wesnoth-1.14-server,
 wesnoth-1.16-server,
# We use systemd-networkd.
# Other network clients shouldn't be there.
# Inmate might use them to set up custom networking.
 network-manager,
 libnm0,
 libnma0,
 ifupdown,
## UPDATE: as at Debian 12, systemd-resolvd Provides resolvconf.
##         It is a stub resolvconf that only understands resolved.
#          It is harmless, so we must remove resolvconf from here.
#          Actually, if I say << 252 it'll block resolvconf and openresolv, but
#          still allow systemd-resolved...
 resolvconf (<< 252.6-1),
 ifupdown2,
 ifupdown-multi,
 mobile-broadband-provider-info,
 modemmanager, usb-modeswitch, comgt, wvdial,
 modem-manager-gui,
 isc-dhcp-client,
 isc-dhcp-server,
 iw,
 wireless-tools,
 wpasupplicant,
 rfkill,
 iptables-persistent,
 netfilter-persistent,
 pppconfig,
 pppd,
 wpan-tools,
 ahcpd,
 airport-utils,
 atm-tools,
 bootpc,
 bootp,
 bridge-utils,
 comitup,
 connman,
 crda,
 dhcpd5,
 ez-ipupdate,
 faifa,
 hostapd,
 ifrename,
 inetutils-tools,
 macchanger,
 net-tools,
 netplug,
 open-iscsi,
 pppoeconf,
 pptp-linux,
 pptpd,
 rancid,
 rarpd,
 tcputils,
 wakeonlan,
 wavemon,
 whereami,
 wide-dhcpv6-client,
 wide-dhcpv6-server,
 wide-dhcpv6-relay,
 wpagui,
 dhcpy6d,
 wmifinfo,
 xfce4-wavelan-plugin,
 dhcpd,
 xl2tpd,
## Inmates MUST NOT have writable local media (DVD, USB)
## =====================================================
# e2fsprogs is shitlisted because in Debian 9 it was hard to avoid.
# Upstream changes mean that shouldn't happen again, but it doesn't hurt.
# UPDATE 2021: e2fsprogs is still needed, by
#              gvfs→gvfs-daemons→udisks2→libblockdev-fs2→e2fsprogs.
# UPDATE 2021: shitlist other mkfs.* packages also (apt-file list bin/mkfs.)
#              Except for
#                 util-linux --- needed for /bin/mount
#                 e2fsprogs  --- handled in prisonpc-ersatz-e2fsprogs
#                 ntfs-3g    --- needed by staff for fuse mount.ntfs-3g
#                 exfat?     --- not needed now exfat is in-kernel (not fuse)?
# UPDATE 2023: genisoimage is no longer needed by disc-snitch.py.
#              Block other ISO mastering things (except libburn4, used by staff).
# NOTE: staff need ntfs-3g https://alloc.cyber.com.au/task/task.php?taskID=24592
# NOTE: staff need exfat   https://alloc.cyber.com.au/task/task.php?taskID=32658
 genisoimage, wodim, growisofs, cdrdao,
 android-sdk,
 bcachefs-tools,
 btrfs-progs,
 calamares-settings-mobian,
 cpmtools,
 dosfstools,
 erofs-utils,
 exfatprogs,
 f2fs-tools,
 gfs2-utils,
 hfsprogs,
 jfsutils,
 mtd-utils,
 nilfs-tools,
 ocfs2-tools,
 reiser4progs,
 reiserfsprogs,
 udftools,
 xfsprogs,
# In theory an inmate could write a userland filesystem with fuse.
# UPDATE 2021: also list (some) packages that Depends: libfuse2 or libfuse3.
# Except: gvfs-fuse / ntfs3g / fuse / fuse3 (needed for staff)
# NOTE: fuse is there because fuse3 Provides: fuse!
# FIXME: pipewire complains about missing xdg-desktop-port -- do we care? --twb, September 2023
# $ aptitude search -F ' %p,' '?depends(^libfuse.*$~|^fuse3?$) ?not(?name(^~(gvfs-fuse~|ntfs-3g~|fuse~|fuse3~)$))'
 afflib-tools,
 afuse,
 android-file-transfer,
 apt-cacher-ng,
 archivemount,
 avfs,
 bindfs,
 btfs,
 casync,
 ceph-fuse,
 ceph-osd,
 charliecloud-runtime,
 clamfs,
 compiz-plugins,
 coop-computing-tools,
 cryfs,
 dislocker,
 disorderfs,
 encfs,
 ewf-tools,
 exfat-fuse,
 ffmpegfs,
 flatpak,
 flatpak-tests,
 fosfat,
 fossil,
 freedombox,
 fuse-convmvfs,
 fuse-overlayfs,
 fuse-posixovl,
 fuse-zip,
 fuse2fs,
 fuseext2,
 fusefat,
 fuseiso,
 fuseiso9660,
 gfarm2fs,
 gnome-remote-desktop,
 gnunet-fuse,
 gocryptfs,
 gphotofs,
 grub-common,
 guestmount,
 httpdirfs,
 httpfs2,
 ifuse,
 jmtpfs,
 kdeconnect,
 kio-fuse,
 libbde-utils,
 libfsapfs-utils,
 libfuse-dev,
 libfuse-perl,
 libfuse3-dev,
 libfvde-utils,
 libguestfs0,
 libmono-fuse-cil,
 libnbd-bin,
 libolecf-utils,
 libqcow-utils,
 libregf-utils,
 libsmraw-utils,
 libsquashfuse0,
 libvhdi-utils,
 libvirt-daemon-driver-lxc,
 libvmdk-utils,
 libvshadow-utils,
 libvslvm-utils,
 libwim15,
 loggedfs,
 lxcfs,
 mergerfs,
 mhddfs,
 moosefs-client,
 mp3fs,
 obexfs,
 obexftp,
 open-vm-tools,
 open-vm-tools-desktop,
 openafs-fuse,
 osspd,
 ostree,
 ostree-tests,
 owfs-fuse,
 pike8.0-fuse,
 plptools,
 python3-fuse,
 python3-fusepy,
 python3-llfuse,
 python3-pyfuse3,
 qemu-system-arm,
 qemu-system-common,
 qemu-system-mips,
 qemu-system-misc,
 qemu-system-ppc,
 qemu-system-sparc,
 qemu-system-x86,
 qemu-utils,
 rbd-fuse,
 rdiff-backup-fs,
 ruby-fusefs,
 s3backer,
 s3fs,
 securefs,
 smbnetfs,
 squashfuse,
 sshfs,
 tmfs,
 tup,
 uml-utilities,
 umview-mod-umfuseiso9660,
 unionfs-fuse,
 vmfs-tools,
 vmfs6-tools,
 winregfs,
 wit,
 xdg-desktop-portal,
 xdg-desktop-portal-tests,
 xmount,
 xrdp,
 xrootd-fuse,
 zfs-fuse,
# Block EVERYTHING doc/NNNNN-udev-audit.py finds creating custom udev rules,
# except for a small set of things we actually want (e.g. udev & udisks2).
#
# Allow list:
#
#   util-linux-extra    --- for everything (we don't need the udev hwclock part though)
#   systemd             --- for everything
#   udev                --- for everything
#   udisks2             --- for DVD drive
#   upower              --- for case power button (eventually)
#   xserver-xorg-core   --- for video
#   pipewire-bin        --- for audio (Debian 12+)
#   nfs-common          --- for mounting /home in Debian 12+; see https://bugs.debian.org/1024082
#   libinput-bin        --- for keyboard and mouse
#   ir-keytable         --- for infrared TV remote control
#   libmtp-common	--- DO NOT WANT, but needs to be nerfed as vlc & gvfs Depends on it via libmtp9
#   libwacom-common     --- DO NOT WANT, but xserver-xorg-input-libinput Depends on it (harmless, though)
#   dmsetup             --- DO NOT WANT, but NFSv4 client Depends on it
#   libgphoto2-6        --- DO NOT WANT, but gvfs-backends Depends on it (staff-only, for sftp:// in thunar)
#   e2fsprogs           --- DO NOT WANT, but already handled as prisonpc-ersatz-e2fsprogs
#   qemu-guest-agent    --- needed for staff VM-ized desktops, blocked in prisonpc-bad-package-conflicts-inmates
#   spice-vdagent       --- needed for staff VM-ized desktops, blocked in prisonpc-bad-package-conflicts-inmates
#
 0xffff,
 air-quality-sensor,
 alsa-firmware-loaders,
 alsa-utils,
 amazon-ec2-net-utils,
 amazon-ec2-utils,
 android-sdk-platform-tools-common,
 antpm,
 aoetools,
 argyll,
 autorandr,
 avarice,
 avrdude,
 awesfx,
 battery-stats,
 bcache-tools,
 beep,
 bilibop-rules,
 bilibop-udev,
 bluez,
 boinc-client,
 bolt,
 bottlerocket,
 bridge-utils,
 brightness-udev,
 btrfs-progs,
 bumblebee,
 casync,
 ceph-common,
 ceph-osd,
 ckb-next,
 cloud-init,
 colord,
 concordance-common,
 console-setup-linux,
 dahdi,
 dahdi-linux,
 daxctl,
 ddcutil,
 dfu-util,
 digimend-dkms,
 direwolf,
 dlm-controld,
 dmraid,
 dmrconfig,
 docker.io,
 dolphin-emu,
 drbd-utils,
 driverctl,
 eegdev-plugins-free,
 eg25-manager,
 ekeyd,
 elogind,
 feedbackd,
 flashrom,
 fpga-icestorm,
 fwupd,
 g15daemon,
 g810-led,
 galileo,
 galileo-daemon,
 garmin-forerunner-tools,
 gcpegg,
 gdm3,
 gfs2-utils,
 gnome-settings-daemon-common,
 gobi-loader,
 goldencheetah,
 google-android-platform-tools-installer,
 gpsd,
 gr-funcube,
 guestfsd,
 hdmi2usb-udev,
 hdparm,
 heimdall-flash,
 hylafax-server,
 hyperv-daemons,
 i2c-tools,
 ifplugd,
 ifrename,
 ifupdown,
 iio-sensor-proxy,
 indi-armadillo-platypus,
 indi-dsi,
 indi-ffmv,
 indi-gphoto,
 indi-nightscape,
 indi-orion-ssg3,
 indi-sx,
 infnoise,
 input-remapper-daemon,
 inputattach,
 ipheth-utils,
 ipp-usb,
 isight-firmware-tools,
 joystick,
 kdump-tools,
 kinect-audio-setup,
 knxd,
 kodi-peripheral-xarcade,
 kpartx,
 laptop-mode-tools,
 lcdproc,
 ledger-wallets-udev,
 libacsccid1,
 libairspy0,
 libairspyhf1,
 libam7xxx0.1,
 libapogee3,
 libasedrive-usb,
 libasi,
 libbladerf2,
 libbmusb6,
 libccid,
 libcomedi0,
 libffado2,
 libfishcamp1,
 libfli2,
 libfprint-2-2,
 libfreenect0.5,
 libgpod-common,
 libgxccd,
 libhackrf0,
 libhamlib4,
 libifd-cyberjack6,
 libiio0,
 libinovasdk1,
 libirecovery-common,
 libkf5bluezqt-data,
 libmirisdr0,
 libnfc6,
 libnitrokey-common,
 libnjb5,
 libnxt,
 libopenni-sensor-pointclouds0,
 libopenni-sensor-primesense0,
 libopenni2-0,
 libopenobex2,
 libosmosdr0,
 libpktriggercord0,
 libplayeronecamera2,
 libpsm2-2-compat,
 librem5-flash-image,
 librem5-tweaks,
 libricohcamerasdk,
 librtlsdr0,
 libsane-hpaio,
 libsane1,
 libsbig4,
 libsigrok4,
 libticables2-8,
 libvpb1,
 libx52pro0,
 libxtrxll0,
 libyubikey-udev,
 light,
 limesuite-udev,
 linuxcnc-uspace,
 liquidctl,
 lomiri-common,
 lomoco,
 ltunify,
 lvm2,
 madfuload,
 madwimax,
 mate-settings-daemon-common,
 mdadm,
 mdevctl,
 media-player-info,
 midisport-firmware,
 minidisc-utils,
 mobile-tweaks-common,
 modemmanager,
 moosefs-chunkserver,
 msi-keyboard,
 mspdebug,
 mt-st,
 mtkbabel,
 mu-editor,
 multipath-tools,
 mustang-plug,
 mutter-common,
 nbc,
 netscript-2.4,
 network-manager,
 nfs-kernel-server,
 nqc,
 nut-ipmi,
 nut-server,
 nvidia-kernel-common,
 nvme-cli,
 ocfs2-tools,
 ofono,
 ola,
 open-iscsi,
 open-vm-tools,
 openfpgaloader,
 openocd,
 openrazer-driver-dkms,
 osspd,
 pcmciautils,
 plasma-mobile-tweaks,
 ponyprog,
 printer-driver-foo2zjs,
 projecteur,
 prusa-slicer,
 pulseaudio,
 python3-btchip,
 python3-elgato-streamdeck,
 qcom-phone-utils,
 qdmr,
 qflipper,
 qlcplus,
 qthid-fcd-controller,
 razercfg,
 rdma-core,
 rear,
 rkdeveloptool,
 scanbd,
 scdaemon,
 sg3-utils-udev,
 solaar,
 spectools,
 spice-webdavd,
 srptools,
 steam-devices,
 stlink-tools,
 sunxi-tools,
 sxmo-utils,
 system-config-printer-udev,
 t2n,
 teensy-loader-cli,
 thunderbolt-tools,
 tlp,
 tlp-rdw,
 tpb,
 tpm-udev,
 trezor,
 triggerhappy,
 tucnak,
 ubertooth,
 udftools,
 udisks2-zram,
 uhd-host,
 ukui-power-manager,
 ukui-settings-daemon,
 usb-modeswitch-data,
 usbauth,
 usbmuxd,
 usbrelay,
 usbsdmux,
 uvcdynctrl,
 voctomix-outcasts,
 w1retap,
 waagent,
 x2gothinclient-smartcardrules,
 x2gothinclient-usbmount,
 xperia-flashtool,
 xpra,
 xr-hardware,
 xserver-xorg-input-wacom,
 xtrx-dkms,
 zfsutils-linux,
## Inmates MUST NOT have containers (VMs)
## ======================================
 libvirt-daemon,
 libvirt-clients,
 gnome-boxes,
 libvirt0,
 qemu-user,
 qemu-system-x86,
 qemu-system-data,
 grub-firmware-qemu,
 ipxe-qemu,
 systemd-container,
 libnss-mymachines,
 gnome-boxes,
## Inmates MUST NOT have root REPL (& SHOULD NOT get any REPL)
## ===========================================================
# NOTE: staff need x-terminal-emulator (xfce4-terminal).
# $ aptitude search -F ' %p,' '(?provides(x-terminal-emulator) | ?tag(terminal) ) ?not(?name(^xfce4-terminal$))'
 alacritty,
 bogl-bterm,
 cool-retro-term,
 deepin-terminal,
 eterm,
 foot,
 fqterm,
 gnome-console,
 gnome-terminal,
 guake,
 kitty,
 konsole,
 lxterminal,
 mate-terminal,
 mlterm,
 mlterm-common,
 mlterm-im-m17nlib,
 mlterm-im-scim,
 mlterm-im-uim,
 mlterm-tiny,
 mlterm-tools,
 mssh,
 pterm,
 putty,
 qterminal,
 rxvt-unicode,
 sakura,
 seyon,
 stterm,
 terminal.app,
 terminator,
 terminology,
 termit,
 tilda,
 tilix,
 xiterm+thai,
 xterm,
 xtermcontrol,
 xtermset,
 xttitle,
 yakuake,
 yeahconsole,
 zutty,
# NOTE: some terminal emulators don't Provides: x-terminal-emulator, so
#       this list is handwritten!
 konsole-kpart,
 fbterm,
 libqtermwidget5-1,
#xfce4-terminal,
#libvte-2.91-0,
 libvte-2.91-gtk4-0,
 libvte-2.91-common,
 libvterm0,
 libvte9,
 libvte-common,
 node-xterm,
 libjs-xterm,
 python3-terminado,
 python3-pyte,
 s3dvt,
 xgterm,
# We need at most one privesc framework.  Block the rest.
# We need thunar->udisks2->polkit for mounting/ejecting DVDs.
 sudo,
 sudo-ldap,
# New in Debian 12 -- pkexec is separated out from polkit-1 itself.
# As a result, we can now explicitly block it.
# UPDATE: no we can't.
# policykit-1 : Depends: pkexec (= 122-3) but it is not going to be installed
# UPDATE: yes we can because we only need polkitd, and policykit-1 is a legacy alias for polkitd + pkexec.
 pkexec,
# Explicitly block polkitd-pkla, a backcompat hack for polkitd.
# We do not use it, and we do not want it accidentally "winning" over
# default-deny .rules we write in modern polkitd's javascript.
 polkitd-pkla,
# kde-cli-tools provides kdesu, the KDE equivalent of pkexec
# kde-cli-tools also provides kdeeject (which might bypass disc drive locking)
 kde-cli-tools, libkf5su5, libkf5su-bin, libkf5su-data,
# chromium-sandbox REDUCES security.
# It should be banned, not installed.
# It is only existing as a workaround for kernels without user_ns.
# https://bugs.debian.org/839277
# https://bugs.debian.org/913116
 chromium-sandbox,
# These are alternatives to the XFCE4 applications/start menu.
# They provide easy ways to run an arbitrary shell command (i.e. Win+R).
# There is no easy way to remove that feature while keeping the "nice menu" feature.
 xfce4-appfinder,
 xfce4-whiskermenu-plugin,
## Inmates SHOULD NOT have a text editor
## =====================================
# NOTE: staff need mousepad (GUI text editor), thus also libgtksourceview-4-0.
# CLI text editors
 editor,
# https://codesearch.debian.net/search?q=update-alternatives+--install+%2Fusr%2Fbin%2Feditor+editor&literal=1
 cream, dav-text, diffstat, e3, efte, elvis-tiny, fte, gnuserv, joe, jove, jupp,
 le, lpe, mc, mg, nano, ne, nedit, neovim, ng, nvi, tilde, vile, xemacs21, yi,
 zile,
 micro,
# GUI text editors (not comprehensive)
# FIXME: not updated for Debian 12.
 pluma,
 juffed,
 gedit,
 kate,
 kwrite,
 retext,
 yudit,
 textedit.app,
# de facto GUI text editors (meant for something else, but you can easily create attack.sh files).
# NOTE: in lyx, use File>Import>Plain text and File>Export>Plain text.
# FIXME: not updated for Debian 12.
 lyx,
 texstudio,
 texmaker,
 kile,
 fritzing,
 robocode,
 vigor,
# The GTK / Qt widgets that provide text editor functionality.
# This will error out if an app has such an editor as an embedded widget.
 libkf5texteditor5,
 libgtksourceview-5-0,
 libgtksourceview-3.0-1,
 gir1.2-gtksource-4,
# ?source-package(kross) is for "embedded scripting", but orthogonal to kf5texteditor?
 kross-dev, kross, libkf5krosscore5, libkf5krossui5,
## Inmates SHOULD NOT have access to cron-style scheduling (#30091)
## ================================================================
# NOTE: systemd timer units can still be used.
 anacron,
 at,
 cron,
 featherpad,
 systemd-cron,
## Inmates SHOULD NOT have miscellaneous scary things
## ==================================================
# In principle IPP2 supports authentication, though
# it happens inside the IPP2 payload, not inside HTTP.
# When we experimentally enabled it,
# we found that it asked for passwords WAY too often.
# We have not gone back and tuned it yet.
# In the meantime, inmates can spoof their identity to the print server with "lp -U alice test.pdf"
# This does not directly affect security, but
# it could affect billing of print resources (paper and ink).
# The quick fix is simply to make sure lp(1) cannot be installed.
# Applications almost always use cups as a library (not CLI fork+exec binaries).
# When used as a library, this spoofing is much harder (maybe impossible).
 cups-client,
# As at Debian 11, python 2.x is obsolete.
# We REALLY should not see it anywhere!
 python2,
# Debian 11 only provides security support for gecko (firefox-esr) and blink (chromium).
# You should assume all other browser engines are insecure.
# https://www.debian.org/releases/stable/arm64/release-notes/ch-information.en.html
# NOTE: cannot rely on check-support-status due to https://bugs.debian.org/1004293
# UPDATE: upstream has now clarified this:
#           "The webkit2gtk and wpewebkit engines ARE covered by security support."
# SAFE: #   ?source-package(^webkit2gtk$)
# SAFE: gir1.2-javascriptcoregtk-4.0, gir1.2-webkit2-4.0, libjavascriptcoregtk-4.0-18,
# SAFE: libjavascriptcoregtk-4.0-bin, libjavascriptcoregtk-4.0-dev,
# SAFE: libwebkit2gtk-4.0-37, libwebkit2gtk-4.0-dev, libwebkit2gtk-4.0-doc,
# SAFE: webkit2gtk-driver,
# SAFE: #   ?source-package(webkit2-sharp)
# SAFE:  libwebkit2-sharp-4.0-cil, libwebkit2-sharp-4.0-cil-dev,
# SAFE:  monodoc-webkit2-sharp-4.0-manual,
#   ?source-package(^pyqt5webengine$)
 python3-pyqt5.qtwebengine, python3-pyqt5.qtwebengine-dbg,
#   ?source-package(^qtwebengine-opensource-src$)
 libqt5pdf5, libqt5pdfwidgets5, libqt5webengine-data, libqt5webengine5,
 libqt5webenginecore5, libqt5webenginewidgets5, qml-module-qtquick-pdf,
 qml-module-qtwebengine, qt5-image-formats-plugin-pdf, qtpdf5-dev, qtpdf5-doc,
 qtpdf5-doc-html, qtpdf5-examples, qtwebengine5-dev, qtwebengine5-dev-tools,
 qtwebengine5-doc, qtwebengine5-doc-html, qtwebengine5-examples,
 qtwebengine5-private-dev,
# SAFE: #   ?source-package(^wpewebkit$)
# SAFE:  libwpewebkit-1.0-3, libwpewebkit-1.0-dev, libwpewebkit-1.0-doc, wpewebkit-driver,
#   ?source-package(^tkhtml1$)
 tk-html1,
#   ?source-package(^khtml$)
 libkf5khtml-bin, libkf5khtml-data, libkf5khtml-dev, libkf5khtml5,
#   ?source-package(^kdewebkit$)
 libkf5webkit-dev, libkf5webkit5,
#   ?source-package(^qtwebkit-opensource-src$)
 libqt5webkit5, libqt5webkit5-dev, qml-module-qtwebkit,
# SAFE: #   ?source-package(^libgtk3-webkit2-perl$)
# SAFE:  libgtk3-webkit2-perl,
#   ?source-package(^wkhtmltopdf$)
 wkhtmltopdf,
#   ?source-package(^mozjs78$)
 libmozjs-78-0, libmozjs-78-dev,
#   ?source-package(^gjs$)
 gjs, libgjs0g, libgjs-dev,
#   ?source-package(^cjs$)
 cjs, libcjs0g, libcjs-dev,
#   ?source-package(^kjsembed$)
 libkf5jsembed-data, libkf5jsembed-dev, libkf5jsembed5,
# Quick-and-dirty incomplete update for Debian 12:
 libqt6webchannel6,
 libqt6webengine6-data,
 libqt6webenginecore6,
 libqt6webenginecore6-bin,
 libqt6webenginequick6,
 libqt6webenginequickdelegatesqml6,
 libqt6webenginewidgets6,
 libqt6websockets6,
 libqt6webview6,
 libqt6webviewquick6,
 pyqt6-webengine-dev,
 python3-pyqt6.qtwebchannel,
 python3-pyqt6.qtwebengine,
 python3-pyqt6.qtwebsockets,
 qt6-webchannel-dev,
 qt6-webengine-dev,
 qt6-webengine-dev-tools,
 qt6-webengine-private-dev,
 qt6-websockets-dev,
 qt6-websockets-private-dev,
 qt6-webview-dev,
 qt6-webview-plugins,
# FIXME: Do the stand-alone js VMs duktape/neko/rhino/mujs get security support, or do they count as "unmaintainable web engines" ?
# For good measure, block www-browser (except chromium/firefox-esr), too.
# Because of the exception, we cannot LITERALLY say www-browser here.
# $ aptitude search -F ' %p,' '?provides(www-browser) ?not(?name(^chromium$))'
 dillo,
 edbrowse,
 elinks,
 epiphany-browser,
 falkon,
 firefox-esr,
 hv3,
 konqueror,
 links,
 links2,
 luakit,
 lynx,
 morph-browser,
 netrik,
 netsurf-fb,
 netsurf-gtk,
 qutebrowser,
 sugar-browse-activity,
 surf,
 w3m,
 xemacs21-mule,
 xemacs21-mule-canna-wnn,
 xemacs21-nomule,
# X11 doesn't REALLY support screen locking:
#   https://www.jwz.org/blog/2021/01/i-told-you-so-2021-edition/
# Rather than pretend, we simply do not let inmate lock the screen.
# This also prevents inmate in a shared area from locking the screen and walking away, which is a sort of DOS.
 xscreensaver,
 kscreensaver,
 gnome-screensaver,
 mate-screensaver,
 cinnamon-screensaver,
 ukui-screensaver,
# Also don't let them suspend.
# FIXME: can probably still suspend via systemd...
 xfce4-power-manager,
 sleepd,
 thermald,
 upower,
# Fuck it, why NOT block this?
 ftp-server,
 httpd,
 httpd-cgi,
 httpd-wsgi,
 imap-server,
 ldap-server,
 irc, ircd,
# Leftovers from delete-bad-files KDE4 lockdown.
# In KDE5, we can block the packages outright.
 plasma-desktop,
 plasma-framework,
 libkf5kcmutils5,
 kde-config-cddb,                kde-config-mobile-networking,
 kde-config-cron,                kde-config-plymouth,
 kde-config-fcitx,               kde-config-screenlocker,
 kde-config-fcitx5,              kde-config-sddm,
 kde-config-gtk-style,           kde-config-systemd,
 kde-config-gtk-style-preview,   kde-config-tablet,
 kde-config-mailtransport,       kde-config-telepathy-accounts,
 khelpcenter,
 kwalletmanager,
# Blacklist everything that provides dbus-1/services/org.kde.*, except kio kded5 libkf5globalaccel-data (kdeedu needs those).
 choqok,
 dolphin,
 elisa,
 k3b,
 kactivitymanagerd,
 kalarm,
 kalendarac,
 kde-config-plymouth,
 kde-config-sddm,
 kde-config-systemd,
 kde-spectacle,
 kde-telepathy-contact-list,
 kdeconnect,
 kdenetwork-filesharing,
 kdesvn-kio-plugins,
 keurocalc-data,
 kget,
 khelpcenter,
 kio-extras-data,
 kio-fuse,
 kmail,
 kongress,
 kontact,
 konversation,
 korganizer,
 kscreen,
 ksysguard,
 ksystemstats,
 ktexteditor-data,
 kwalletmanager,
 libkf5libkdepim-dev,
 libkf5screen-bin,
 libkf5sysguard-data,
 libkf5wallet-bin,
 libkpmcore10,
 plasma-desktop-data,
 plasma-dialer,
 plasma-discover-backend-snap,
 plasma-disks,
 plasma-workspace,
 plasma-workspace-data,
 powerdevil,
 smb4k,
 yakuake,
# Blacklist everything that provides /usr/lib/x86_64-linux-gnu/qt5/plugins/kf5/kio/ except kio itself.
 baloo-kf5,
 bluedevil,
 kamera,
 kde-zeroconf,
 kdeconnect,
 kdepim-runtime,
 kio-admin,
 kio-audiocd,
 kio-extras,
 kio-gdrive,
 kio-gopher,
 kio-ldap,
 kio-perldoc,
 krusader,
 libk3b-extracodecs,
 libkf5kdelibs4support5-bin,
 okular-extra-backends,
 plasma-workspace,
# Blacklist everything that provides polkit*kde.
 k3b,
 kalarm,
 kde-config-cron,
 kde-config-plymouth,
 kde-config-sddm,
 kde-config-systemd,
 kdenetwork-filesharing,
 kdevelop-python-data,
 kinfocenter,
 kinit,
 kio-admin,
 ktexteditor-data,
 kwalletmanager,
 libkf5sysguard-data,
 libkpmcore10,
 libkpmcore12,
 plasma-desktop-data,
 plasma-discover-backend-snap,
 plasma-disks,
 plasma-firewall,
 plasma-workspace-data,
 polkit-kde-agent-1,
 powerdevil,
 smb4k,
## Inmates SHOULD NOT be able to use VLC for evil
## ==============================================
## Inmates SHOULD NOT have packaging tools
## =======================================
 packagekit,
 packagekit-tools,
 dpkg-dev,
 python3-apt,
## Inmates SHOULD NOT have diagnostic tools
## ========================================
# certutil lets inmates manipulate who Chromium trusts.
 libnss3-tool,
 gnutls-bin,
# drkonqi - report crash to KDE over http
 drkonqi,
# libkf5xmlgui-bin includes ksendbugemail, which sounds undesirable.
 libkf5xmlgui-bin,
# iproute2 includes super useful "ip" and "ss" debugging tools.
# In Debian 9, we used it.  In Debian 11 we don't.
 iproute2,
# acl includes rarely-used debugging "getfacl" and "setfacl".
# In Debian 9 systemd's postinst used these.
# In Debian 11, systemd-tmpfiles does this via C code.
# So we can just block this package entirely.
 acl,
## Inmates SHOULD NOT have development tools
## =========================================
 libc-dev, libc6-dev,
# libc-dev should be enough to block most compiler stuff.
# $ aptitude search -F ' %p,' '?name(-compiler$)'
 blueprint-compiler,
 brig-compiler,
 c++-compiler,
 c-compiler,
 c-sharp-2.0-compiler,
 c-sharp-3.0-compiler,
 c-sharp-4.0-compiler,
 c-sharp-4.5-compiler,
 c-sharp-compiler,
 closure-compiler,
 d-compiler,
 d-v2-compiler,
 default-d-compiler,
 device-tree-compiler,
 elm-compiler,
 flatbuffers-compiler,
 fortran-compiler,
 fortran77-compiler,
 fortran95-compiler,
 fp-compiler,
 go-compiler,
 haskell-compiler,
 inform6-compiler,
 java-compiler,
 libnvidia-compiler,
 libnvidia-tesla-470-compiler,
 libnvidia-tesla-compiler,
 lisp-compiler,
 m2-compiler,
 node-vue-template-compiler,
 node-webassemblyjs-helper-compiler,
 node-weex-template-compiler,
 objc++-compiler,
 objc-compiler,
 protobuf-c-compiler,
 protobuf-compiler,
 rake-compiler,
 ruby-ffi-compiler,
 sludge-compiler,
 thrift-compiler,
 vkd3d-compiler,
# Some compilers don't have a "Provides: rust-compiler" so have to be denylisted by hand.
 rustc,
 clang,
 llvm,
 llvm-14,
 pkgconf,
 wx-common,
 golang-1.20-go,
 golang-1.21-go,
# ----------------------------------------------------------------------
# Fuck it, let's explicitly block EVERY package whose name ends in -dev!
# $ aptitude search -F ' %p,' '?name(-dev$)'
# UPDATE: this takes like 5 minutes of 100% CPU to run "dh binary", and
#         over 20 minutes at 100% CPU to run "lintian".
#         Apparently lintian does not scale to 30,000+ Conflicts lines...
#         How about it we limit this just -dev packages that *anything* depends on?
#         And do not themselves depend on any -dev package?
#         That will eliminate all the golang -dev packages which have 0 dependencies and 0 reverse dependencies.
#         That reduces the package list from ~37000 to ~2500.
# $ aptitude search -F ' %p,' '?name(-dev$) ?reverse-depends(.) ?not(?depends(?name(-dev$)))'
#
# UPDATE:
#
# <jwilk> Couldn't you block installing packages by pinning?
# <jwilk> "P < 0    prevents the version from being installed"
# <twb> Offhand I'm not sure, but you might be right.
#       I think the error message would be less clear, though.
#       Right now I get an error message like
#
#           The following packages have unmet dependencies:
#            prisonpc-bad-package-conflicts-everyone : Conflicts: fuse
#            xfce4-terminal : Depends: libvte-2.91-0 (>= 0.51.90) but it is not installable
#           E: Unable to correct problems, you have held broken packages.
#
# <twb> When I started that approach, I did not understand pinning as well as I do today.
#       jwilk: ah I found one reason: can't "Conflicts: x-terminal-emulator" in apt preferences.
#       Works well for *-dev, though it doesn't print the Explanation line.
#       AND you can bypass it if you do "apt install libc6-dev/bookworm", so it's not actually 100% working.
#
#           root@hera:/# cat >/etc/apt/preferences.d/fuck
#           Package: *-dev
#           Pin: version *
#           Pin-Priority: -1
#
#           root@hera:/# apt install libc6-dev
#           Package libc6-dev is not available, but is referred to by another package.
#           This may mean that the package is missing, has been obsoleted, or
#           is only available from another source
#           However the following packages replace it:
#             rpcsvc-proto libcrypt-dev libnsl-dev
#           E: Package 'libc6-dev' has no installation candidate
#
#           root@hera:/# apt install libc6-dev/stable
#           Selected version '2.36-9+deb12u1' (Debian:12.1/stable [amd64]) for 'libc6-dev'
#           Some packages could not be installed. This may mean that you have
#           requested an impossible situation or if you are using the unstable
#           distribution that some required packages have not yet been created
#           or been moved out of Incoming.
#           The following information may help to resolve the situation:
#           The following packages have unmet dependencies:
#            libc6-dev : Depends: linux-libc-dev but it is not installable
#                        Depends: libcrypt-dev but it is not installable
#                        Depends: libnsl-dev but it is not installable
#           E: Unable to correct problems, you have held broken packages.
#
#           root@hera:/# apt install libc6-dev -t stable
#           Package libc6-dev is not available, but is referred to by another package.
#           This may mean that the package is missing, has been obsoleted, or
#           is only available from another source
#           However the following packages replace it:
#             rpcsvc-proto libcrypt-dev libnsl-dev
#
#           E: Package 'libc6-dev' has no installation candidate
#
# This is Good Enough for the "*-dev" case, though.
# It is also useful as defence-in-depth against libvte-1-2 becoming libvte-3-4.
# Because we can glob in apt_preferences, we can denylist "libvte-*" easily.
# ----------------------------------------------------------------------
#
# IDEs (not comprehensive)
# FIXME: not updated for Debian 12.
 geany,
 devhelp,
 gnome-devel,
 gnome-builder,
 glade,
 gnome-api-docs,
 manpages-dev,
 lazarus-ide,
 kdevelop,
 gambas3,
 eric,
 spyder,
 jupyter-core,
 jypyter-server,
 python3-pandas,
 thonny,
 valinor,
 idle,
 idle3,
 pyzo,
 faustworks,
# groovy provides groovyConsole, a basic REPL and text editor.
 groovy,
# $ aptitude search -F ' %p,' '?tag(devel::ide)'
# FIXME: some of these are commented out -- why?
 anjuta,
 anjuta-common,
 bpython,
 codeblocks-dev,
 codelite,
#coqide,
 eric,
 fp-ide,
 geany,
 gnome-builder,
 idle,
 kdevelop,
 ktechlab,
#kturtle,
 lazarus,
 lazarus-ide,
 lazarus-ide-gtk2,
#puredata,
 qtcreator,
 qtcreator-doc,
 sbcl,
#sludge-devkit,
 spyder,
#squeak-vm,
 tkcon,
 xwpe,
 yforth,
 yorick,
# Version control tools (not comprehensive)
# FIXME: not updated for Debian 12.
 git,
 mercurial,
 rcs,
 svn,
 fossil,
 bzr,
 brz,
# Debuggers (not comprehensive)
# FIXME: not updated for Debian 12.
 god,
# As at Debian 11, python2 is ONLY supported for building packages.
# Since inmates should never do this, it is safe & reasonable to block python2 outright.
 python-is-python2,
 python2,
 python2-minimal,
 python2.7-minimal,
 libpython2.7,
 libpam-python,
 python-dev-is-python2,
# While I'm at it, also block some obviously-dev-only python packages.
# Not removing e.g. python3-distutils because stuff actually needs that.
 2to3,
 python3-dev,
 python3-devpi-common,
 python3-venv,
 pipx,
 python3-pip,
 python-dev-is-python3,
# $ apt-file search -l bin/dh_ | grep -vFw -e python3-numpy -e xml-core -e perl-openssl-defaults | sed 's/.*/ &,/'
# ...except python3-numpy (for solarwolf)
# ...except xml-core (for dia)
# ...except perl-openssl-defaults (for gnucash)
#
# AFAICT perl-openssl-defaults does two jobs:
# 1. at install time, it just aliases libssl1.1 (as here); and
# 2. at build time, it provides dh_perl_openssl.
# We do not care about (2), but it's not spooky enough to bother spoofing.
 apache2-dev,
 autotools-dev,
 bash-completion,
 cli-common-dev,
 click-dev,
 cme,
 config-package-dev,
 debhelper,
 dh-acc,
 dh-ada-library,
 dh-apparmor,
 dh-autoreconf,
 dh-buildinfo,
 dh-cmake,
 dh-consoledata,
 dh-coq,
 dh-cruft,
 dh-di,
 dh-dist-zilla,
 dh-dkms,
 dh-elpa,
 dh-fortran-mod,
 dh-golang,
 dh-linktree,
 dh-lisp,
 dh-lua,
 dh-make,
 dh-nodejs,
 dh-nss,
 dh-ocaml,
 dh-octave,
 dh-octave-autopkgtest,
 dh-perl6,
 dh-php,
 dh-puredata,
 dh-python,
 dh-r,
 dh-raku,
 dh-rebar,
 dh-runit,
 dh-strip-nondeterminism,
 dh-sysuser,
 dh-vim-addon,
 dh-virtualenv,
 dh-xsp,
 dictionaries-common-dev,
 doxygen,
 gem2deb,
 germinate,
 gnome-pkg-tools,
 gnustep-make,
 gobject-introspection,
 haskell-devscripts-minimal,
 kodi-addons-dev,
 libdbi-perl,
 libgstreamer1.0-dev,
 libimager-perl,
 libva-dev,
 libxine2-dev,
 mkdocs,
 mozilla-devscripts,
 nginx-dev,
 pdl,
 pidgin-dev,
 pkg-kde-tools,
 pkg-php-tools,
 postgresql-server-dev-all,
 ppp-dev,
 pyppd,
 python3-ply,
 python3-sip-dev,
 quilt,
 scour,
 sphinx-common,
 tex-common,
 uwsgi-dev,
 vagrant,
 vdr-dev,
 xserver-xorg-dev,
 yorick-dev,
 zathura-dev,
# Noticed this at the same time (cpan2deb)...
 pypi2deb,
 dh-make-perl,
# Noticed this one at the same time...
# NOTE: dracut needs pkg-config (WTF, why?)
 pkg-config,
 pkgconf,
# $ apt-file search --package-only usr/src
 acpi-call-dkms,
 adv-17v35x-dkms,
 apfs-dkms,
 bazel-bootstrap-source,
 bbswitch-dkms,
 bbswitch-source,
 bf-utf-source,
 binutils-source,
 bluez-source,
 broadcom-sta-dkms,
 broadcom-sta-source,
 bsh-src,
 castle-game-engine-src,
 cloop-src,
 dahdi-dkms,
 dahdi-source,
 ddcci-dkms,
 digimend-dkms,
 dm-writeboost-dkms,
 dpdk-kmods-dkms,
 dynare-matlab,
 evdi-dkms,
 falcosecurity-scap-dkms,
 gcc-11-source,
 gcc-12-source,
 gcc-arm-none-eabi-source,
 gdb-source,
 glibc-source,
 google-mock,
 googletest,
 gost-crypto-dkms,
 iptables-netflow-dkms,
 jool-dkms,
 langford-dkms,
 leds-alix-source,
 libgtest-dev,
 libhalide14-0-dev,
 liblzf-dev,
 libpython3.11-dev,
 librem-ec-acpi-dkms,
 libxcrypt-source,
 lime-forensics-dkms,
 linux-config-6.1,
 linux-config-6.4,
 linux-headers-6.1.0-10-amd64,
 linux-headers-6.1.0-10-cloud-amd64,
 linux-headers-6.1.0-10-common,
 linux-headers-6.1.0-10-common-rt,
 linux-headers-6.1.0-10-rt-amd64,
 linux-headers-6.1.0-11-amd64,
 linux-headers-6.1.0-11-cloud-amd64,
 linux-headers-6.1.0-11-common,
 linux-headers-6.1.0-11-common-rt,
 linux-headers-6.1.0-11-rt-amd64,
 linux-headers-6.1.0-9-amd64,
 linux-headers-6.1.0-9-cloud-amd64,
 linux-headers-6.1.0-9-common,
 linux-headers-6.1.0-9-common-rt,
 linux-headers-6.1.0-9-rt-amd64,
 linux-headers-6.4.0-0.deb12.2-amd64,
 linux-headers-6.4.0-0.deb12.2-cloud-amd64,
 linux-headers-6.4.0-0.deb12.2-common,
 linux-headers-6.4.0-0.deb12.2-common-rt,
 linux-headers-6.4.0-0.deb12.2-rt-amd64,
 linux-kbuild-6.1,
 linux-kbuild-6.4.0-0.deb12.2,
 linux-source-6.1,
 linux-source-6.4,
 linux-support-6.1.0-10,
 linux-support-6.1.0-11,
 linux-support-6.1.0-9,
 linux-support-6.4.0-0.deb12.2,
 lttng-modules-dkms,
 mate-submodules-source,
 matlab-gdf,
 matlab-zmat,
 mono-source,
 nat-rtsp-dkms,
 newlib-source,
 nvidia-fs-dkms,
 nvidia-kernel-dkms,
 nvidia-kernel-source,
 nvidia-open-kernel-dkms,
 nvidia-open-kernel-source,
 nvidia-tesla-470-kernel-dkms,
 nvidia-tesla-470-kernel-source,
 nvidia-tesla-kernel-dkms,
 nvidia-tesla-kernel-source,
 ocaml-source,
 openafs-modules-dkms,
 openafs-modules-source,
 openrazer-driver-dkms,
 openvpn-dco-dkms,
 openvswitch-source,
 paho.mqtt.c-examples,
 pocl-source,
 propellor,
 python3-cxx-dev,
 r8125-dkms,
 r8168-dkms,
 rapiddisk-dkms,
 rtpengine-kernel-dkms,
 rust-src,
 selinux-policy-src,
 tp-smapi-dkms,
 ubertooth-firmware-source,
 uclibc-source,
 uwsgi-src,
 v4l2loopback-dkms,
 v4l2loopback-source,
 vpb-driver-source,
 vpoll-dkms,
 wabt,
 west-chamber-dkms,
 west-chamber-source,
 xorg-server-source,
 xtables-addons-dkms,
 xtables-addons-source,
 xtrx-dkms,
 zfs-dkms,
# Holy shit, after all that, "make" was still allowed???
# FIXME: not updated for Debian 12.
 make,
 automake,
 autoconf,
 autotools-dev,
 meson,
 ninja-build,
 generate-ninja,
 cmake,
 scons,
 acr,
 soong, mini-soong,
 yotta,
# Other than bash and ash, ?section(shells) aren't inherently bad, but
# anything explicitly depending on them is almost certainly a Bad Thing that we Do Not Want.
# $ aptitude search -F ' %p,' '?section(shells) ?not(?name(^[bd]ash$))'
 ash,
 autojump,
 bash-completion,
 bash-static,
 bats,
 busybox-static,
 cleo,
 csh,
 elvish,
 fdclone,
 fish,
 fish-common,
 fizsh,
 ksh,
 ksh93u+m,
 mksh,
 mono-csharp-shell,
 posh,
 rc,
 rush,
 sash,
 screenie,
 tcsh,
 xonsh,
 yash,
 zgen,
 zplug,
 zsh,
 zsh-antigen,
 zsh-autosuggestions,
 zsh-common,
 zsh-static,
 zsh-syntax-highlighting,
# Block ?name(firmware) and ?section(firmware) for things that we definite DO NOT want.
# e.g. broadcom bluetooth drivers.
# This stanza is generated by hand.
 arm-trusted-firmware-tools,
 crust-firmware,
 grub-firmware-qemu,
 bladerf-firmware-fx3,
 dahdi-firmware-nonfree,
 gnome-firmware,
 firmware-microbit-micropython-doc,
 nxt-firmware,
 sigrok-firmware-fx2lafw,
 isight-firmware-tools,
 firmware-b43-installer,
 firmware-b43legacy-installer,
 atmel-firmware,
 bluez-firmware,
 firmware-ast,
 firmware-atheros,
 firmware-bnx2,
 firmware-bnx2x,
 firmware-brcm80211,
 firmware-cavium,
#firmware-intel-sound,
 firmware-ipw2x00,
 firmware-ivtv,
 firmware-libertas,
 firmware-myricom,
 firmware-netronome,
 firmware-netxen,
 firmware-nvidia-gsp,
 firmware-nvidia-tesla-gsp,
 firmware-qcom-soc,
 firmware-qlogic,
 firmware-realtek-rtl8723cs-bt,
 firmware-samsung,
 firmware-siano,
#firmware-sof-signed,
 firmware-ti-connectivity,
 firmware-zd1211,
 hackrf-firmware,
 firmware-ath9k-htc,
 firmware-tomu,
 raspi-firmware,
 firmware-qcom-media,
 dns323-firmware-tools,
 firmware-microbit-micropython,
 ubertooth-firmware,
 ubertooth-firmware-source,
 alsa-firmware-loaders,
 midisport-firmware,
 hdmi2usb-fx2-firmware,
## Useless & confusing menu items SHOULD be hidden (#30257)
## ========================================================
## Useless & confusing "under the hood" files MAY be removed
## =========================================================
# FIXME: java-wrappers depends on dpkg.
#        https://github.com/cyberitsolutions/bootstrap2020/blob/main/debian-12-PrisonPC.hooks/customize80-purge-bad-packages.py
#        could fix this by simply replacing "$(dpkg --print-architecture)" with "amd64".
#        This is only useful for 47 apps total, so blacklisting for now.
#        Of those 47, only these are interesting:
#          * Anno 1600 clone  https://freecol.org/
#          * Room planner     https://www.sweethome3d.com/
#          * Mind Map         https://freeplane.org/
#        They haven't even been reviewed yet, because fuck it.
 java-wrappers,
## sysvinit compatibility MAY be removed
## =====================================
## Inmates SHOULD NOT be able to make screenshots
## ==============================================
## https://alloc.cyber.com.au/task/task.php?taskID=30713
# NOTE: staff need xfce4-screenshoter.
# x11-apps provides "xwd" screenshot tool.
# FIXME: not updated for Debian 12.
 scrot,
 x11-apps,
 gnome-screenshot,
 gtk-vector-screenshot,
 deepin-screenshot,
 fbcat,
 flameshot,
 kde-spectacle,
 ksnip,
 screengrab,
 mirage,
 screenfetch,
 kazam,
 gkrellshoot,
 grim,
 grimshot,
 maim,
 mate-utils,
Architecture: all
Description: conflict with CANTHAPPEN packages
 Some packages should NEVER be installed (e.g. terminal emulators).
 Sometimes updates cause apt to start installing such a package.
 When this happens, the build should abort, so a human can investigate.
 .
 Note that this is different from a prisonpc-ersatz-* package.
 Ersatz packages are where we HAVE DECIDED the best option is to lie to apt.
 This package is for things where we HAVEN'T DECIDED yet.
 .
 One easy way to test for this is to ask for task-xfce-desktop, which
 should fail due to a conflict relating to X terminal emulators.
 .
 Most bad packages can be banned for everyone (this package).
 A few things inmates MUST NOT have, but staff MUST have.
 That is done in prisonpc-bad-package-conflicts-inmates.
