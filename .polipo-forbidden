#!/bin/bash
# If it looks like an FQDN, that FQDN is forbidden.
# Otherwise it's in the "too-hard" basket.
#
# See http://adblockplus.org/en/subscriptions huge block lists.
# This little munger makes EREs of its globbing-plus-NIH syntax.
#
# FIXME: integrate this list?  http://adaway.org/hosts.txt
hostrev () { local a fqdn new; while IFS=. read -ra fqdn; do new=(); for ((a = ${#fqdn[@]} - 1; a >= 0; a--)); do new+=("${fqdn[a]}"); done; ( IFS=.; printf '%s\n' "${new[*]}" ); done; }
for l in {easyprivacy,easylist,fanboy-annoyance}; do URL=https://easylist.to/easylist/$l.txt; echo "## FROM $URL $(date -I)"; curl -sSfL "$URL" | grep '^||[a-z0-9.]*[a-z][a-z0-9.]*\^$' | tr -d '|^' | hostrev | sort | hostrev | while read -r domain; do printf '127.254.254.254 %s.blacklisted.invalid %32s\n' "$l" "$domain"; done; done

